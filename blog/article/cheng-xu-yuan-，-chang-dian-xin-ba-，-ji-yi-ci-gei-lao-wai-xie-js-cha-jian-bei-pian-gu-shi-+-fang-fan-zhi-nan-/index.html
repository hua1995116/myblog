<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title> 程序员，长点心吧，记一次给老外写js插件被骗故事 + 防范指南
  </title>
  <script src='https://unpkg.com/nprogress@0.2.0/nprogress.js'></script>
  <link rel='stylesheet' href='https://unpkg.com/nprogress@0.2.0/nprogress.css' />
  <link rel="stylesheet" type="text/css" href="/css/style.css">
  <link rel="stylesheet" type="text/css" href="/css/github-markdown.css">
  <link rel="stylesheet" type="text/css" href="/css/prism.css">
  <link rel="stylesheet" type="text/css" href="/css/blog_index.css">
  <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
</head>

<body scroll="no">
  <header>
    <nav class="nav">
      <ul class="title clear">
        <a href="/index.html">
          Home
        </a>
        <a href="/blog/tag">
          Tags
        </a>
        <a href="https://juejin.im/user/5964cb3a6fb9a06bb0194421">
          <img src="https://s3.qiufengh.com/blog/juejin.png" alt="">
        </a>
        <a href="https://github.com/hua1995116/">
          <img src="https://s3.qiufengh.com/blog/GitHub.png" alt="">
        </a>
        <a href="/blog" class="cta">
          Blog
        </a>
      </ul>
    </nav>
  </header>
  <div class="body-content clear">
    <section>
      <div class="detail-content">
        <div class="header">
          <h1>
            程序员，长点心吧，记一次给老外写js插件被骗故事 + 防范指南

          </h1>
        </div>
        <div class="timer">
          2019-02-22
        </div>
        <div class="readers">
          阅读量<span id="busuanzi_value_page_pv"></span>
        </div>
        <div class="type clear">
          <span class="span_button"> 文章
          </span>
        </div>
        <div class="content markdown-body">
          <h1 id="-">前因</h1>
          <p>前几天一个外国友人发邮件给我，有偿帮他写一个提交抢签证的脚本。心里想着反正也没事，还可以锻炼自己的英文水平，就加了他的 whatsApp，一开始他非常的友好，各种舔，说我们中国人是很聪明的，然后划重点他说是 Github 找到的我，一想确实我在Github 留下了我的邮箱。 </p>
          <p>以下是展示友好的对话。
            <img src="https://s3.qiufengh.com/blog/WechatIMG292.jpeg" alt="WechatIMG292.jpeg"></p>
          <p><img src="https://s3.qiufengh.com/blog/WechatIMG291.jpeg" alt="WechatIMG291.jpeg"></p>
          <p><img src="https://s3.qiufengh.com/blog/WechatIMG293.jpeg" alt="WechatIMG293.jpeg"></p>
          <p>因为工作原因加上时差，我只有半夜的时候才能帮他看问题，所以这几天每天搞到凌晨2点多，还有帮他开发的那个插件是应用于一个 algeria (阿尔及利亚) 的地址。必须他们那边的 IP 才能访问，然后我每天半夜，开着 TeamViewer 远程来调试来帮他写代码。看下面这图。</p>
          <p><img src="https://s3.qiufengh.com/blog/WechatIMG290.jpeg" alt="WechatIMG290.jpeg"></p>
          <p>呵呵了，说翻脸就翻脸，这人真的，还和发誓，说一定会 Pay me（在我看来外国友人都是发誓对他们来说是很严重的事情，所以我对他万分相信。）。然后这人一开始媒每天非常积极地和我说话，现在已经2天没回我了，而且他一直在线上，就是不鸟我，被骗无疑，所以特此来告知下大家。</p>
          <p>记住上面这个人，大家千万别被骗（当然你想锻炼一下自己的外文水平，不反对:), 但是如果涉及金钱问题请你慎重。）</p>
          <h1 id="-">为什么会被骗？</h1>
          <p>作为一个程序员，难道连这么点防范措施都没有吗？ 不，我是有防范措施的。我有在代码里面注入了一些额外的东西。原本这些东西真的能成为我的砝码。。</p>
          <p>但是，看了上面，你们也可以看出来，这哥们真的蛮真诚的。。我在最后交付的时候，老外让我把源码给他，因为之前给了他一个压缩 + 混淆 的版本。。。但是最后交付的时候我傻逼了。心里想着，就要交付了，老外聊的还可以，我还在代码里面写了一些暗门，我心里太阴暗了。再加上整个库打包后太大了，粘贴在 tampermonkey的时候不方便， 我就把把 js 解释器给去了，因为钱没到手，所以留了一个小小的口子。后来发现，我把动态代码传 cdn 了。然后又忘记在链接后面加时间戳动态获取了。。。。GG，这样就会有本地缓存，所以基本就是被骗去了一个插件。（只能暗自祈祷，这个老外赶紧强刷浏览器吧，赶紧失效吧。）</p>
          <h1 id="-">防范指南</h1>
          <p>记住上面那个老外，阿尔及利亚的。 大家们别被骗了，我估计近期他还会对我们 Chinese 下手，因为看他的样子应该很熟练。</p>
          <p>下面来讲下我刚才说的暗门（前面是我自己傻逼，把这些东西给去了），一般来讲这种让你写脚本的，本身不懂脚本怎么写，所以有很多方法。</p>
          <ol>
            <li>setTimeout, 定时器，因为写插件，涉及执行效率问题，我们可以故意将脚本执行时间延长，从而使得脚本可行性降低。</li>
            <li>利用 eval 和 new Function 特性动态插入代码，最好核心代码都写成这样子的。</li>
            <li>加入一个 js 解释器，然后你的核心代码都通过远程请求回来再执行。(可以参考这个 <a href="https://github.com/bramblex/jsjs">https://github.com/bramblex/jsjs</a> )</li>
            <li>设置脚本执行开关，和 3 类似，每次向自己的服务请求回代码来进行判断。</li>
          </ol>
          <p>我就是用了上述的1，3，4 方法。。。但是我傻逼了。我把 1，3 去了，留了一个4，但是我用 4 方法是去请求一个 cdn json，类似这样。</p>
          <pre><code class="lang-json">{
  &quot;data&quot;: &quot;true&quot;
}
</code></pre>
          <p>哎。但是我就是我忘记给 url 加上时间戳，所以那个脚本会一直缓存在他电脑里。。。（除非他强刷下缓存，哎，算了算了，吃一堑长一智，希望大家不要像我一样）一手好牌被打的稀巴烂。 还有给了测试 demo 可以收一定的押金，（我因为不好意思，所以没说）然后再把源码交给他。哎，程序员只能通过这种方式来保障自己的权益了。</p>
          <p>好了，就这样。(吐槽完，真香。</p>
          <h1 id="-">打个广告</h1>
          <p>作者这么惨了，关注波公众号，安慰下我受伤的心灵吧。</p>
          <p><img src="https://user-gold-cdn.xitu.io/2019/1/24/1688055012ff10bc?w=500&amp;h=500&amp;f=png&amp;s=19651" alt=""></p>

          <!-- <div class="view-cnt">（111 人已阅）</div> -->
        </div>
        <div class="my-pay">
          <div class="my-pay-btn">赞赏</div>
          <div class="my-pay-type clear">
            <div class="my-pay-alipay my-pay-div"></div>
            <div class="my-pay-weixin my-pay-div"></div>
          </div>
        </div>
      </div>

      <div id="container"></div>
    </section>

  </div>
  <div class="blog-bottom">
    <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  <footer id="footer">
    <p class="small">© Copyright 2019 qiufenghua</p>
  </footer>
  <script type="text/javascript" src="/js/prism.js"></script>
  <script src="/js/axios.js"></script>
  <script>
    NProgress.start();
    window.onload = function() {
      NProgress.done();
    }
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?f12dade0d0c1d020a5c06231f05b9f65";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
      var myPayBtn = document.querySelector('.my-pay-btn');
      var myPayType = document.querySelector('.my-pay-type');
      var btnShow = true;
      myPayBtn.addEventListener('click', function() {
        if (btnShow) {
          myPayType.style.display = 'block';
          btnShow = false;
        } else {
          myPayType.style.display = 'none';
          btnShow = true;
        }
      });
    })();
  </script>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <script>
    var gitment = new Gitment({
      id: location.href, // 可选。默认为 location.href
      owner: 'hua1995116',
      repo: 'myblog',
      oauth: {
        client_id: '814dc8bc817d0a663020',
        client_secret: 'ae232061068d5844c3665b55e34d7d5edb220113',
      },
    })
    gitment.render('container')
  </script>
</body>

</html>